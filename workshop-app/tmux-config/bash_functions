#!/usr/bin/env bash

# Bash functions for tmux workshop

# Configure SSH for Git operations
SSH_DIR="${HOME}/.ssh"
if [ ! -d "$SSH_DIR" ] && [ -d "/opt/app-root/src/.ssh" ]; then
    # Use the mounted SSH directory if ~/.ssh doesn't exist
    SSH_DIR="/opt/app-root/src/.ssh"
fi

if [ -f "$SSH_DIR/id_rsa" ]; then
    # Start ssh-agent if not already running
    if [ -z "$SSH_AGENT_PID" ]; then
        eval "$(ssh-agent -s)" > /dev/null 2>&1
        ssh-add "$SSH_DIR/id_rsa" > /dev/null 2>&1
    fi
    
    # Configure Git to use SSH properly
    export GIT_SSH_COMMAND="ssh -i $SSH_DIR/id_rsa -o StrictHostKeyChecking=no -o UserKnownHostsFile=$SSH_DIR/known_hosts"
fi

# Function to display help
tmux_help() {
    echo "Atalhos do tmux Workshop / tmux Workshop Shortcuts"
    echo "=================================================="
    echo ""
    echo "Prefix: Ctrl + s"
    echo ""
    echo "Sessoes / Sessions:"
    echo "  Prefix + N    - Nova sessao / New session"
    echo "  Prefix + .    - Renomear sessao / Rename session"
    echo "  Prefix + w    - Lista sessoes / List sessions"
    echo "  Prefix + K    - Encerrar sessao / Kill session"
    echo ""
    echo "Janelas / Windows:"
    echo "  Ctrl + t      - Nova janela / New window"
    echo "  Shift + setas - Navegar janelas / Navigate windows"
    echo "  Prefix + ,    - Renomear janela / Rename window"
    echo "  Prefix + k    - Encerrar janela / Kill window"
    echo ""
    echo "Paineis / Panes:"
    echo "  Ctrl + \\      - Dividir horizontal / Split horizontal"
    echo "  Prefix + -    - Dividir vertical / Split vertical"
    echo "  Ctrl + setas  - Navegar paineis / Navigate panes"
    echo "  Prefix + a    - Sincronizar / Synchronize"
    echo ""
    echo "FZF:"
    echo "  Ctrl + x      - Buscar arquivos / Find files"
    echo "  Ctrl + r      - Historico / History"
    echo "  Prefix + Tab  - Buscar URLs / Find URLs"
    echo "  Prefix + b    - Buffers"
}

alias th='tmux_help'
